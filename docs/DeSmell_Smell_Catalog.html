<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DeSmell — Smell Detection Catalog</title>
  <style>
    :root{
      --bg:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --codebg:#f9fafb;
      --link:#2563eb;
      --h:#0f172a;
      --chip:#eef2ff;
      --chipText:#3730a3;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font: 15px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    .wrap{max-width:1000px; margin:0 auto; padding:32px 20px 64px;}
    header{
      padding-bottom:18px;
      border-bottom:1px solid var(--border);
      margin-bottom:24px;
    }
    h1{
      margin:0 0 8px 0;
      font-size:28px;
      letter-spacing:-0.02em;
      color:var(--h);
    }
    .subtitle{margin:0; color:var(--muted)}
    a{color:var(--link); text-decoration:none}
    a:hover{text-decoration:underline}
    .grid{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:24px;
      align-items:start;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
    }
    nav{
      border:1px solid var(--border);
      border-radius:12px;
      padding:16px 16px 12px;
      background:#fff;
      position:sticky;
      top:16px;
    }
    nav h2{
      margin:0 0 10px 0;
      font-size:16px;
      color:var(--h);
    }
    nav ol, nav ul{
      margin:8px 0 0 18px;
      padding:0;
    }
    nav li{margin:4px 0}
    nav .lvl2{margin-top:6px}
    main section{
      padding:18px 18px;
      border:1px solid var(--border);
      border-radius:12px;
      margin-bottom:16px;
      background:#fff;
    }
    main h2{
      margin:0 0 8px 0;
      font-size:20px;
      color:var(--h);
      letter-spacing:-0.01em;
    }
    main h3{
      margin:14px 0 6px 0;
      font-size:15px;
      color:var(--h);
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin:10px 0 2px;
      color:var(--muted);
      font-size:13px;
    }
    .chip{
      display:inline-block;
      padding:2px 10px;
      border-radius:999px;
      background:var(--chip);
      color:var(--chipText);
      border:1px solid #e0e7ff;
      font-size:12px;
      font-weight:600;
    }
    .kvs{
      width:100%;
      border-collapse:collapse;
      margin:8px 0 0 0;
    }
    .kvs th, .kvs td{
      border-top:1px solid var(--border);
      padding:10px 10px;
      vertical-align:top;
    }
    .kvs th{
      width:220px;
      color:var(--muted);
      font-weight:600;
      text-align:left;
      background:#fff;
    }
    .code{
      background:var(--codebg);
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px 12px;
      overflow:auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12.5px;
    }
    .note{
      border-left:4px solid #93c5fd;
      background:#eff6ff;
      padding:10px 12px;
      border-radius:8px;
      margin:10px 0 0 0;
      color:#0f172a;
    }
    .summary{
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px 16px;
      background:#fff;
      margin:0 0 16px 0;
    }
    .summary h2{margin:0 0 10px 0; font-size:18px}
    .summary table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    .summary th,.summary td{
      border-top:1px solid var(--border);
      padding:10px 8px;
      text-align:left;
      vertical-align:top;
    }
    .summary th{color:var(--muted); font-weight:700}
    footer{
      margin-top:28px;
      color:var(--muted);
      font-size:13px;
    }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>DeSmell — Smell Detection Catalog</h1>
    <p class="subtitle">
      Operational definitions of each presentation-layer smell detected by DeSmell, including
      metrics, formulas, thresholds, and reporting scope. This document is intended to be committed
      alongside the detectors in the repository.
    </p>
  </header>

  <div class="grid">
    <nav aria-label="Table of Contents">
      <h2>Table of Contents</h2>
      <ol>
        <li><a href="#overview">Overview</a></li>
        <li>
          <a href="#catalog">Smell Catalog</a>
          <ol class="lvl2">
            <li><a href="#cfc">Composable Function Complexity (CFC)</a></li>
            <li><a href="#constants">Constants in Composable</a></li>
            <li><a href="#sed">High Side-Effect Density (SED)</a></li>
            <li><a href="#liu">Logic in UI Density (LIU)</a></li>
            <li><a href="#multi-flow">Multiple Flow Collections per Composable</a></li>
            <li><a href="#ms-cond">MutableState in Boolean Conditions</a></li>
            <li><a href="#ms-mutation">MutableState Mutation in Composable</a></li>
            <li><a href="#remember-saveable">Non-Savable Type in rememberSaveable</a></li>
            <li><a href="#rus-constant">rememberUpdatedState with Constant</a></li>
            <li><a href="#reused-key">Reused Key in Nested Scope</a></li>
            <li><a href="#sec">Side-Effect Complexity (SEC)</a></li>
            <li><a href="#slot-count">Slot Count in Composable</a></li>
          </ol>
        </li>
        <li><a href="#appendix-metrics">Appendix: Metric Definitions</a></li>
      </ol>
    </nav>

    <main>
      <section id="overview">
        <h2>Overview</h2>
        <div class="meta">
          <span class="chip">Repository-ready</span>
          <span class="chip">Detector-aligned</span>
          <span class="chip">Metric-based</span>
        </div>

        <p>
          DeSmell operationalizes a taxonomy of twelve declarative UI presentation-layer smells for Jetpack Compose
          by extracting structural and semantic signals from Kotlin AST/UAST and applying explicit thresholds.
          The smell taxonomy and the evaluation positioning are described in the accompanying manuscript
          (<em>Static Detection of Presentation-Layer Code Smells in Declarative Android Architectures</em>). 
        </p>

        <p>
          This catalog is aligned with the rule specifications used by the detectors (rule set “rules.pdf”) and
          uses the same metric names (e.g., <code>SEC</code>, <code>SED</code>, <code>uiNodeCount</code>) and thresholds where applicable.
          Where the paper draft describes an earlier formulation (e.g., statement-based density),
          the detector-aligned definition in <em>rules.pdf</em> is treated as the source of truth for repository documentation.
        </p>
      </section>

      <div class="summary" id="catalog">
        <h2>Smell Catalog Summary</h2>
        <table aria-label="Smell Summary Table">
          <thead>
            <tr>
              <th>Detector ID</th>
              <th>Smell</th>
              <th>Primary Metric</th>
              <th>Primary Threshold</th>
              <th>Reporting Scope</th>
            </tr>
          </thead>
          <tbody>
            <tr><td><code>ComposableFunctionComplexityIssue</code></td><td>CFC</td><td>Weighted complexity score</td><td><code>CFC ≥ 25</code> (or <code>loops &gt; 4</code>)</td><td>Composable</td></tr>
            <tr><td><code>ConstantsInComposable</code></td><td>Constants in Composable</td><td>Occurrence count</td><td>Any occurrence</td><td>Declaration site</td></tr>
            <tr><td><code>HighSideEffectDensityIssue</code></td><td>SED</td><td><code>sideEffectCount/uiNodeCount</code></td><td><code>SED ≥ 0.30</code> and <code>sideEffectCount ≥ 2</code></td><td>Composable</td></tr>
            <tr><td><code>LogicInUIIssue</code></td><td>LIU</td><td>Control-flow density</td><td><code>LIU &gt; 0.30</code> (with guards)</td><td>Composable</td></tr>
            <tr><td><code>MultipleFlowCollectionsPerComposable</code></td><td>Multiple Flow Collections</td><td>Flow collection count</td><td><code>&gt; 2</code></td><td>Composable</td></tr>
            <tr><td><code>MutableStateInCondition</code></td><td>MutableState in Conditions</td><td>Occurrence count</td><td>Any occurrence</td><td>Condition site</td></tr>
            <tr><td><code>MutableStateMutationInComposable</code></td><td>MutableState Mutation</td><td>Occurrence count</td><td>Any occurrence</td><td>Mutation site</td></tr>
            <tr><td><code>NonSavableRememberSaveable</code></td><td>Non-savable rememberSaveable</td><td>Occurrence count</td><td>Any occurrence</td><td>Call site</td></tr>
            <tr><td><code>RememberUpdatedStateWithConstant</code></td><td>rememberUpdatedState with Constant</td><td>Occurrence count</td><td>Any occurrence</td><td>Call site</td></tr>
            <tr><td><code>ReusedKeyInNestedScope</code></td><td>Reused Key in Nested Scope</td><td>Binary</td><td>Any repeated nested key reuse</td><td>Key/effect site</td></tr>
            <tr><td><code>SideEffectComplexityIssue</code></td><td>SEC</td><td>Weighted effect complexity</td><td><code>SEC ≥ 10</code></td><td>Side-effect call</td></tr>
            <tr><td><code>SlotCountInComposable</code></td><td>Slot Count</td><td>Slot count</td><td><code>&gt; 3</code> (or per-project override)</td><td>Composable signature</td></tr>
          </tbody>
        </table>
        <p class="note">
          Thresholds and metric formulas below follow the detector-aligned rule spec (rules.pdf). Where the paper’s narrative uses
          slightly different density formulas or guard logic in a draft section, treat this HTML as the repository reference for current implementation.
        </p>
      </div>

      <!-- 1 -->
      <section id="cfc">
        <h2>Composable Function Complexity (CFC)</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>ComposableFunctionComplexityIssue</code></span>
          <span class="chip">Architectural Responsibility &amp; Logic Leakage</span>
        </div>

        <table class="kvs" aria-label="CFC Spec">
          <tr>
            <th>Intent</th>
            <td>
              Identify composables that accumulate structural complexity, side-effect orchestration, and data access
              responsibilities, indicating controller-like behavior and reduced maintainability.
            </td>
          </tr>
          <tr>
            <th>Signals Counted</th>
            <td>
              <ul>
                <li><strong>Branches:</strong> <code>if</code>, <code>else-if</code>, and <code>when</code> entries (excluding <code>else</code>)</li>
                <li><strong>Loops:</strong> imperative (<code>for</code>, <code>while</code>, <code>do-while</code>) and functional loops (<code>forEach</code>, <code>map</code>, <code>filter</code>, …)</li>
                <li><strong>maxDepth:</strong> maximum control nesting depth</li>
                <li><strong>SEC_total:</strong> sum of Side-Effect Complexity (SEC) across effect blocks in the composable</li>
                <li><strong>SED:</strong> side-effect block count (used as an additive factor)</li>
                <li><strong>parameters:</strong> count of parameters (excluding design-only params)</li>
                <li><strong>viewModelAccesses:</strong> number of ViewModel accesses</li>
                <li><strong>statementCount:</strong> collected for reporting/diagnostics (not used in the score)</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Metric / Formula</th>
            <td>
              <div class="code">CFC = 2×branches + 3×loops + 2×maxDepth + 1×SEC_total + 2×SED + 1×parameters + 3×viewModelAccesses</div>
            </td>
          </tr>
          <tr>
            <th>Thresholds</th>
            <td>
              <ul>
                <li><strong>Primary threshold:</strong> <code>CFC ≥ 25</code> (configurable)</li>
                <li><strong>Hard rule:</strong> <code>loops &gt; 4</code> ⇒ always reported</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>
              Report at the composable function location with a metric breakdown (branches, loops, depth, SEC_total, SED, parameters, ViewModel accesses).
            </td>
          </tr>
        </table>
      </section>

      <!-- 2 -->
      <section id="constants">
        <h2>Constants in Composable</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>ConstantsInComposable</code></span>
          <span class="chip">Recomposition Efficiency &amp; State Handling</span>
        </div>

        <table class="kvs" aria-label="Constants in Composable Spec">
          <tr>
            <th>Intent</th>
            <td>Prevent redundant allocation/recomputation by flagging immutable constants declared inside composable bodies.</td>
          </tr>
          <tr>
            <th>Detection Rule</th>
            <td>
              Flag a <code>val</code> declared inside a composable whose initializer is constant/immutable and is not wrapped in <code>remember {}</code>.
            </td>
          </tr>
          <tr>
            <th>“Constant” Includes</th>
            <td>
              Literals; constant expressions; <code>dp</code>/<code>sp</code> extensions; immutable factory calls (e.g., <code>listOf</code>, <code>mapOf</code>);
              constructor calls with constant arguments; string templates without interpolation.
            </td>
          </tr>
          <tr>
            <th>Exclusions</th>
            <td>
              <ul>
                <li><code>var</code> declarations</li>
                <li>Anything inside <code>remember { ... }</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td><strong>Zero tolerance:</strong> any occurrence is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the constant declaration site with a concise “hoist or remember” recommendation.</td>
          </tr>
        </table>
      </section>

      <!-- 3 -->
      <section id="sed">
        <h2>High Side-Effect Density (SED)</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>HighSideEffectDensityIssue</code></span>
          <span class="chip">Side-Effect Orchestration</span>
        </div>

        <table class="kvs" aria-label="SED Spec">
          <tr>
            <th>Intent</th>
            <td>Flag composables where lifecycle/reactive orchestration dominates the UI surface, suggesting misplaced coordination logic.</td>
          </tr>
          <tr>
            <th>Side-Effects Counted</th>
            <td>
              <ul>
                <li><code>LaunchedEffect</code>, <code>DisposableEffect</code>, <code>SideEffect</code></li>
                <li><code>produceState</code>, <code>produceRetainedState</code></li>
                <li>Restartable effects and effect-like constructs used for orchestration</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>UI Node Counting</th>
            <td>
              <strong>uiNodeCount</strong> is the number of composable UI calls (render-layer composable invocations), not raw statement count.
            </td>
          </tr>
          <tr>
            <th>Metric / Formula</th>
            <td><div class="code">SED = sideEffectCount / uiNodeCount</div></td>
          </tr>
          <tr>
            <th>Thresholds</th>
            <td>
              <ul>
                <li><code>sideEffectCount ≥ 2</code></li>
                <li><code>SED ≥ 0.30</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Additional Diagnostics</th>
            <td>
              Report additional notes when:
              <ul>
                <li>Duplicate <code>LaunchedEffect</code> keys are observed</li>
                <li>Effects could be consolidated (multiple effects with shared dependencies)</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the composable function location with sideEffectCount, uiNodeCount, and computed SED.</td>
          </tr>
        </table>

        <div class="note">
          Implementation note: the manuscript draft discusses a statement-based density variant in one section; the repository documentation follows
          the detector-aligned definition that uses <code>uiNodeCount</code>.
        </div>
      </section>

      <!-- 4 -->
      <section id="liu">
        <h2>Logic in UI Density (LIU)</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>LogicInUIIssue</code></span>
          <span class="chip">Architectural Responsibility &amp; Logic Leakage</span>
        </div>

        <table class="kvs" aria-label="LIU Spec">
          <tr>
            <th>Intent</th>
            <td>Detect composables where imperative decision-making dominates, indicating controller-like logic leakage into the UI layer.</td>
          </tr>
          <tr>
            <th>Control Flow Counted</th>
            <td>
              <ul>
                <li><code>if</code>, <code>else-if</code></li>
                <li><code>when</code> (entries − 1, i.e., excluding <code>else</code>)</li>
                <li>Loops: <code>for</code>, <code>while</code>, <code>do-while</code>, and functional loops</li>
                <li><code>break</code>, <code>continue</code>, <code>throw</code></li>
                <li><code>try</code> / <code>catch</code> / <code>finally</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Weighting</th>
            <td>
              <ul>
                <li><strong>Render control flow</strong> (directly shaping UI structure): weight <code>1.0</code></li>
                <li><strong>Behavioral control flow</strong> (inside callbacks / modifiers): weight <code>0.5</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Metric / Formula</th>
            <td><div class="code">LIU = (CF_render + 0.5×CF_behavior) / totalStatements</div></td>
          </tr>
          <tr>
            <th>Guards</th>
            <td>
              <ul>
                <li>Skip if <code>totalStatements &lt; 5</code></li>
                <li>Skip if <code>controlFlowCount &lt; 2</code></li>
                <li>Skip if <code>controlFlowCount &gt; 6</code> (to avoid noisy “already obvious” controller cases being overreported by this detector)</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td><code>LIU &gt; 0.30</code> (with guards above).</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>
              Report at the composable function location with CF_render, CF_behavior, totalStatements, controlFlowCount, and computed LIU.
            </td>
          </tr>
        </table>
      </section>

      <!-- 5 -->
      <section id="multi-flow">
        <h2>Multiple Flow Collections per Composable</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>MultipleFlowCollectionsPerComposable</code></span>
          <span class="chip">Architectural Responsibility &amp; Logic Leakage</span>
        </div>

        <table class="kvs" aria-label="Multiple Flow Collections Spec">
          <tr>
            <th>Intent</th>
            <td>Flag composables that collect too many independent reactive streams, increasing recomposition triggers and coupling to state management.</td>
          </tr>
          <tr>
            <th>What Counts</th>
            <td>
              Distinct invocations of:
              <ul>
                <li><code>collectAsState</code></li>
                <li><code>collectAsStateWithLifecycle</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Metric</th>
            <td><div class="code">flowCollectionCount = number of distinct flow-collection calls inside the composable</div></td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td><strong>Maximum allowed:</strong> 2. Report when <code>flowCollectionCount &gt; 2</code>.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the composable function location with the measured flowCollectionCount.</td>
          </tr>
        </table>
      </section>

      <!-- 6 -->
      <section id="ms-cond">
        <h2>MutableState in Boolean Conditions</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>MutableStateInCondition</code></span>
          <span class="chip">Recomposition Efficiency &amp; State Handling</span>
        </div>

        <table class="kvs" aria-label="MutableState in Conditions Spec">
          <tr>
            <th>Intent</th>
            <td>
              Prevent recomposition inefficiencies and reduced readability caused by reading mutable state directly inside conditionals
              rather than using a derived or stable value.
            </td>
          </tr>
          <tr>
            <th>Detection Rule</th>
            <td>
              Flag usages of <code>MutableState</code> values in boolean or comparison expressions (e.g., <code>if</code> conditions, comparisons, <code>when</code> subject)
              when the expression reads <code>.value</code> (or delegated state) inside the condition.
            </td>
          </tr>
          <tr>
            <th>Flagged Examples</th>
            <td>
              <div class="code">if (count.value &gt; 3) { ... }
when (state.value) { ... }</div>
            </td>
          </tr>
          <tr>
            <th>Allowed Patterns</th>
            <td>
              <ul>
                <li><code>if (myBooleanState)</code> when the type is <code>MutableState&lt;Boolean&gt;</code></li>
                <li><code>when</code> over enums</li>
                <li>Use of <code>derivedStateOf</code> / precomputed stable values</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td>Per occurrence (no aggregation). Any detected occurrence is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the conditional expression location.</td>
          </tr>
        </table>
      </section>

      <!-- 7 -->
      <section id="ms-mutation">
        <h2>MutableState Mutation in Composable</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>MutableStateMutationInComposable</code></span>
          <span class="chip">Recomposition Efficiency &amp; State Handling</span>
        </div>

        <table class="kvs" aria-label="MutableState Mutation Spec">
          <tr>
            <th>Intent</th>
            <td>
              Enforce idempotent composition by detecting state mutation during composition, which can cause feedback loops and unpredictable recompositions.
            </td>
          </tr>
          <tr>
            <th>Detection Rule</th>
            <td>
              Flag any mutation of state in the composable body:
              <ul>
                <li><code>state.value = ...</code></li>
                <li>delegated state assignment: <code>var x by remember { mutableStateOf(...) }; x = ...</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Exclusions</th>
            <td>
              Mutations performed:
              <ul>
                <li>Inside callbacks (e.g., onClick lambdas)</li>
                <li>Inside side-effect blocks (e.g., <code>LaunchedEffect</code>)</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td>Per occurrence. Any mutation outside the excluded scopes is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the mutation site.</td>
          </tr>
        </table>
      </section>

      <!-- 8 -->
      <section id="remember-saveable">
        <h2>Non-Savable Type in rememberSaveable</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>NonSavableRememberSaveable</code></span>
          <span class="chip">State Restoration &amp; Lifecycle Correctness</span>
        </div>

        <table class="kvs" aria-label="rememberSaveable Spec">
          <tr>
            <th>Intent</th>
            <td>
              Prevent silent state restoration failures by detecting non-savable types used with <code>rememberSaveable</code> without an explicit saver.
            </td>
          </tr>
          <tr>
            <th>Detection Rule</th>
            <td>
              Flag <code>rememberSaveable</code> usages where the stored type cannot be persisted through Bundle/state restoration and no custom <code>Saver</code> is provided.
            </td>
          </tr>
          <tr>
            <th>Savable Types</th>
            <td>
              Primitives, <code>String</code>, enums, <code>Parcelable</code>, <code>Serializable</code>, and types annotated/handled as serializable.
            </td>
          </tr>
          <tr>
            <th>Exclusions</th>
            <td>Calls that provide a valid custom <code>Saver</code>.</td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td>Per occurrence. Any non-savable usage is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the <code>rememberSaveable</code> call site with the inferred non-savable type.</td>
          </tr>
        </table>
      </section>

      <!-- 9 -->
      <section id="rus-constant">
        <h2>rememberUpdatedState with Constant</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>RememberUpdatedStateWithConstant</code></span>
          <span class="chip">Recomposition Efficiency &amp; State Handling</span>
        </div>

        <table class="kvs" aria-label="rememberUpdatedState Constant Spec">
          <tr>
            <th>Intent</th>
            <td>
              Flag misuse of <code>rememberUpdatedState</code> when wrapping immutable values, which obscures intent and introduces unnecessary snapshot reads.
            </td>
          </tr>
          <tr>
            <th>Detection Rule</th>
            <td>
              Flag <code>rememberUpdatedState(x)</code> when <code>x</code> is constant/immutable (literals, immutable factories, <code>const val</code>, stable function references),
              and the usage does not involve changing callbacks/lambdas.
            </td>
          </tr>
          <tr>
            <th>Exclusions</th>
            <td>Lambdas/callbacks that are expected to change across recompositions.</td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td>Per occurrence. Any qualifying usage is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the <code>rememberUpdatedState</code> call site.</td>
          </tr>
        </table>
      </section>

      <!-- 10 -->
      <section id="reused-key">
        <h2>Reused Key in Nested Scope</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>ReusedKeyInNestedScope</code></span>
          <span class="chip">State Restoration &amp; Lifecycle Correctness</span>
        </div>

        <table class="kvs" aria-label="Reused Key Spec">
          <tr>
            <th>Intent</th>
            <td>
              Detect redundant reuse of identical key expressions across nested recomposition/effect scopes, which obscures invalidation boundaries and can introduce unnecessary recomposition checks.
            </td>
          </tr>
          <tr>
            <th>Targeted APIs</th>
            <td>
              <code>key(...)</code>, <code>LaunchedEffect(...)</code>, <code>DisposableEffect(...)</code>, <code>produceState(...)</code>.
            </td>
          </tr>
          <tr>
            <th>Detection Logic</th>
            <td>
              <ol>
                <li>Extract key expressions (non-lambda arguments).</li>
                <li>Traverse ancestor scopes: if a parent key intersects with the current key ⇒ violation.</li>
                <li>Inter-procedural check: detect key variables passed into child composables and reused again as keys deeper in the call tree.</li>
              </ol>
            </td>
          </tr>
          <tr>
            <th>Metric</th>
            <td>Binary (existence-based). First violation is reported to avoid noise.</td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td>Any repeated key reuse across nested scopes is reported.</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the key/effect call site, including the reused key expression(s) where available.</td>
          </tr>
        </table>
      </section>

      <!-- 11 -->
      <section id="sec">
        <h2>Side-Effect Complexity (SEC)</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>SideEffectComplexityIssue</code></span>
          <span class="chip">Side-Effect Orchestration</span>
        </div>

        <table class="kvs" aria-label="SEC Spec">
          <tr>
            <th>Intent</th>
            <td>
              Flag side-effect blocks whose internal complexity indicates misuse of effect APIs for orchestration/business logic.
              SEC is also reused as an input metric for CFC.
            </td>
          </tr>
          <tr>
            <th>Side-Effects Analyzed</th>
            <td>
              <code>LaunchedEffect</code>, <code>DisposableEffect</code>, <code>SideEffect</code>, <code>produceState</code>, <code>produceRetainedState</code>,
              and restartable nested launches/async inside effects.
            </td>
          </tr>
          <tr>
            <th>Metrics Collected (inside effect lambda)</th>
            <td>
              <ul>
                <li><strong>branches:</strong> <code>if</code>, <code>when</code></li>
                <li><strong>loops:</strong> <code>for</code>, <code>while</code>, <code>do-while</code></li>
                <li><strong>maxDepth:</strong> max nesting depth of control structures</li>
                <li><strong>launchedScopes:</strong> nested <code>launch</code>, <code>async</code>, or restartable scopes inside the effect</li>
                <li><strong>statements:</strong> approximate size via statement counting</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th>Metric / Formula</th>
            <td>
              <div class="code">SEC = 2×branches + 3×loops + 2×maxDepth + 3×launchedScopes + floor(statements/10)</div>
            </td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td><code>SEC ≥ 10</code> ⇒ report.</td>
          </tr>
          <tr>
            <th>Reporting Scope</th>
            <td>Reported on the specific side-effect call site (not the composable), with a full metric breakdown.</td>
          </tr>
        </table>
      </section>

      <!-- 12 -->
      <section id="slot-count">
        <h2>Slot Count in Composable</h2>
        <div class="meta">
          <span><strong>Detector ID:</strong> <code>SlotCountInComposable</code></span>
          <span class="chip">API Design &amp; Component Composition</span>
        </div>

        <table class="kvs" aria-label="Slot Count Spec">
          <tr>
            <th>Intent</th>
            <td>Detect overly complex composable APIs that expose too many composable lambda “slots,” increasing cognitive load and reducing discoverability.</td>
          </tr>
          <tr>
            <th>What Counts as a Slot</th>
            <td>
              A parameter counts as a slot if:
              <ol>
                <li>It is a function/lambda type, and</li>
                <li>It is annotated with <code>@Composable</code>.</li>
              </ol>
              Examples: <code>content: @Composable () -&gt; Unit</code>, <code>header: @Composable RowScope.() -&gt; Unit</code>.
            </td>
          </tr>
          <tr>
            <th>Metric</th>
            <td><div class="code">slotCount = number of @Composable lambda parameters</div></td>
          </tr>
          <tr>
            <th>Threshold</th>
            <td><strong>Max allowed:</strong> 3. Report when <code>slotCount &gt; 3</code>.</td>
          </tr>
          <tr>
            <th>Severity</th>
            <td>Low–medium (API design smell; typically not a runtime correctness defect).</td>
          </tr>
          <tr>
            <th>Reporting</th>
            <td>Report at the composable declaration with slotCount and the list of slot parameter names (where available).</td>
          </tr>
        </table>
      </section>

      <section id="appendix-metrics">
        <h2>Appendix: Metric Definitions</h2>
        <table class="kvs" aria-label="Metric Definitions">
          <tr>
            <th>branches</th>
            <td>Count of conditional branch points (<code>if</code>/<code>else-if</code>, and <code>when</code> entries excluding <code>else</code>).</td>
          </tr>
          <tr>
            <th>loops</th>
            <td>Count of loop constructs; includes imperative loops and selected functional iteration calls (e.g., <code>forEach</code>, <code>map</code>, <code>filter</code>).</td>
          </tr>
          <tr>
            <th>maxDepth</th>
            <td>Maximum nesting depth of control structures (branches/loops/try-catch) within the analyzed scope.</td>
          </tr>
          <tr>
            <th>sideEffectCount</th>
            <td>Number of side-effect blocks detected inside a composable (e.g., <code>LaunchedEffect</code>, <code>DisposableEffect</code>, etc.).</td>
          </tr>
          <tr>
            <th>uiNodeCount</th>
            <td>Number of composable UI calls used to render UI (render-layer composable invocations). Used by SED.</td>
          </tr>
          <tr>
            <th>SEC_total</th>
            <td>Sum of SEC values across all side-effect blocks in a composable. Used as an input to CFC.</td>
          </tr>
          <tr>
            <th>viewModelAccesses</th>
            <td>Count of ViewModel access expressions inside the composable (e.g., direct property/method reads used for UI coordination).</td>
          </tr>
        </table>
      </section>
    </main>
  </div>
</div>
</body>
</html>
